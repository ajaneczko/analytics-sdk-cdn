<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Test Fixed Analytics SDK</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      max-width: 800px;
      margin: 50px auto;
      padding: 20px;
      background: #f5f5f5;
    }
    .card {
      background: white;
      border-radius: 8px;
      padding: 20px;
      margin-bottom: 20px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    h1 { margin-top: 0; }
    .success { 
      background: #d4edda; 
      color: #155724; 
      padding: 15px;
      border-radius: 4px;
      margin: 15px 0;
    }
    .error { 
      background: #f8d7da; 
      color: #721c24; 
      padding: 15px;
      border-radius: 4px;
      margin: 15px 0;
    }
    button {
      background: #0070f3;
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: 4px;
      cursor: pointer;
      margin: 5px;
      font-size: 14px;
    }
    button:hover { background: #0060df; }
    code {
      background: #f0f0f0;
      padding: 2px 6px;
      border-radius: 3px;
      font-family: 'Courier New', monospace;
    }
    pre {
      background: #282c34;
      color: #abb2bf;
      padding: 15px;
      border-radius: 4px;
      overflow-x: auto;
    }
    .badge {
      display: inline-block;
      padding: 4px 8px;
      background: #28a745;
      color: white;
      border-radius: 3px;
      font-size: 12px;
      font-weight: bold;
    }
  </style>
</head>
<body>

  <div class="card">
    <h1>‚úÖ Fixed Analytics SDK Test</h1>
    <p>This page tests the browser-compatible IIFE version.</p>
    
    <div id="status">
      <p>‚è≥ Loading SDK...</p>
    </div>
  </div>

  <div class="card">
    <h2>üß™ Test Actions</h2>
    
    <button onclick="testIdentify()">Test Identify User</button>
    <button onclick="testTrack()">Test Track Event</button>
    <button onclick="testReset()">Test Reset</button>
    
    <div id="results"></div>
  </div>

  <div class="card">
    <h2>üìã What Was Fixed</h2>
    
    <h3>‚ùå Before (Broken):</h3>
    <pre>export class Analytics {
  // ES6 module syntax
  // Doesn't work in &lt;script&gt; tags
}</pre>
    
    <h3>‚úÖ After (Working):</h3>
    <pre>(function(window) {
  'use strict';
  
  class Analytics {
    // Wrapped in IIFE
    // Works everywhere!
  }
  
  window.Analytics = Analytics;
})(window);</pre>
  </div>

  <div class="card">
    <h2>üîÑ Clear Browser Cache</h2>
    <p>If you still see the error, clear your browser cache:</p>
    
    <h3>Chrome / Edge:</h3>
    <ol>
      <li>Press <code>Ctrl + Shift + Delete</code> (Windows) or <code>Cmd + Shift + Delete</code> (Mac)</li>
      <li>Select "Cached images and files"</li>
      <li>Click "Clear data"</li>
      <li>Refresh this page with <code>Ctrl + F5</code></li>
    </ol>

    <h3>Firefox:</h3>
    <ol>
      <li>Press <code>Ctrl + Shift + Delete</code></li>
      <li>Select "Cache"</li>
      <li>Click "Clear Now"</li>
      <li>Refresh with <code>Ctrl + F5</code></li>
    </ol>

    <h3>Safari:</h3>
    <ol>
      <li>Safari Menu ‚Üí Preferences ‚Üí Advanced</li>
      <li>Check "Show Develop menu"</li>
      <li>Develop ‚Üí Empty Caches</li>
      <li>Refresh with <code>Cmd + R</code></li>
    </ol>

    <h3>Quick Fix:</h3>
    <p>Open DevTools (F12) ‚Üí Network tab ‚Üí Check "Disable cache" ‚Üí Refresh</p>
  </div>

  <!-- Load Fixed Analytics SDK -->
  <script src="https://ajaneczko.github.io/analytics-sdk-cdn/analytics.min.js"></script>
  <script src="https://ajaneczko.github.io/analytics-sdk-cdn/auto-track.js"></script>

  <script>
    const statusDiv = document.getElementById('status');
    const resultsDiv = document.getElementById('results');

    // Check if Analytics loaded
    if (typeof Analytics !== 'undefined') {
      statusDiv.innerHTML = `
        <div class="success">
          <strong>‚úÖ SDK Loaded Successfully!</strong><br>
          <span class="badge">FIXED</span> No more "Unexpected token 'export'" error!
        </div>
      `;

      // Initialize Analytics
      window.analytics = new Analytics({
        endpoint: 'https://analytics-collector-pi.vercel.app',
        orgKey: 'test-org-key',
        debug: true
      });

      console.log('[Test] Analytics initialized:', analytics);
    } else {
      statusDiv.innerHTML = `
        <div class="error">
          <strong>‚ùå SDK Not Loaded</strong><br>
          Analytics is undefined. Please clear your browser cache.
        </div>
      `;
    }

    function testIdentify() {
      if (!window.analytics) {
        alert('Analytics not loaded!');
        return;
      }

      analytics.identify('test_user_123', {
        email: 'test@example.com',
        name: 'Test User',
        plan: 'premium'
      });

      resultsDiv.innerHTML = `
        <div class="success">
          ‚úÖ <strong>Identify Called!</strong><br>
          User ID: test_user_123<br>
          Check console for details.
        </div>
      `;
    }

    function testTrack() {
      if (!window.analytics) {
        alert('Analytics not loaded!');
        return;
      }

      analytics.track('test_event', {
        action: 'button_click',
        timestamp: new Date().toISOString()
      });

      resultsDiv.innerHTML = `
        <div class="success">
          ‚úÖ <strong>Event Tracked!</strong><br>
          Event: test_event<br>
          Check console for details.
        </div>
      `;
    }

    function testReset() {
      if (!window.analytics) {
        alert('Analytics not loaded!');
        return;
      }

      analytics.reset();

      resultsDiv.innerHTML = `
        <div class="success">
          ‚úÖ <strong>User Reset!</strong><br>
          localStorage cleared.<br>
          Check console for details.
        </div>
      `;
    }

    // Log version info
    console.log('%c[Analytics SDK Test]', 'color: #0070f3; font-weight: bold; font-size: 14px');
    console.log('SDK Version: Browser-compatible IIFE');
    console.log('Module syntax: ‚ùå Removed');
    console.log('Global variable: ‚úÖ window.Analytics');
    console.log('Status: ‚úÖ Working');
  </script>

</body>
</html>

